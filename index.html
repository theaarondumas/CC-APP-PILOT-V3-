<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Verifi ‚Äî Verification Required (Crash Carts)</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="app">

    <!-- TOP BAR -->
    <header class="topbar">
      <div class="topbar__title">
        <div class="h1">Verification Required<br/>Crash Carts</div>
        <div class="sub">Role-based verification ‚Ä¢ Tech + Nursing (separate screens)</div>
        <div class="sub" id="windowMeta"></div>
      </div>

      <div class="topbar__actions noPrint">
        <div class="seg">
          <button id="navTech" class="segBtn active" type="button">Tech</button>
          <button id="navNursing" class="segBtn" type="button">Nursing</button>
        </div>

        <label class="pill pill--toggle">
          <input id="readyToggle" type="checkbox" />
          <span class="toggleTrack"></span>
          <span class="toggleLabel">Verification Window Open</span>
        </label>
      </div>
    </header>

    <!-- TECH VIEW -->
    <div id="techView">

      <section class="panel" id="verificationSetupPanel">
        <div class="panelRow">
          <div class="panelTitle">Verification Setup (Tech)</div>
          <div class="panelSub" id="roundMeta">No carts in progress</div>
        </div>

        <div class="controlGrid">
          <div>
            <div class="fieldLabel">Verification category</div>
            <div class="tabs" id="cartTypeTabs">
              <button class="tab active" data-type="Adult ‚Äì Towers" type="button">Adult ‚Äì Towers</button>
              <button class="tab" data-type="Adult ‚Äì ER / Procedural" type="button">Adult ‚Äì ER / Procedural</button>
              <button class="tab" data-type="Neonatal" type="button">Neonatal</button>
              <button class="tab" data-type="Broselow" type="button">Broselow</button>
            </div>
          </div>

          <div>
            <div class="fieldLabel">üè• Department / Area</div>
            <select id="departmentSelect" class="select"></select>
          </div>
        </div>

        <!-- ADD CART + AT RISK -->
        <div class="addCartRow">
          <input
            id="cartNumberInput"
            class="cartInput"
            type="tel"
            inputmode="numeric"
            pattern="[0-9]*"
            placeholder="Enter cart ID (numbers)"
            autocomplete="off"
            autocorrect="off"
            autocapitalize="off"
            spellcheck="false"
          />
          <button id="addCartBtn" class="pill pill--outline" type="button">Add to Verification</button>
          <button id="atRiskBtn" class="pill pill--risk" type="button" title="Jump to the first at-risk cart">AT RISK</button>
        </div>

        <div class="toolbarRow noPrint">
          <button id="clearRoundBtn" class="pill pill--outline" type="button">Clear Verification</button>
          <button id="exportJsonBtn" class="pill pill--outline" type="button">Export Verification Record (JSON)</button>
        </div>

        <div class="miniHint">
          Verify carts as you walk. Exceptions surface automatically.
          <strong>If it isn‚Äôt verified, it doesn‚Äôt protect.</strong>
        </div>
      </section>

      <!-- CARTS -->
      <section id="cartList" class="cartList"></section>

      <!-- SUMMARY -->
      <section class="panel">
        <div class="panelRow" style="margin-bottom:10px;">
          <div class="panelTitle">Verification Summary</div>
          <div class="panelSub" id="nursingMeta">Exceptions only</div>
        </div>

        <div class="impactRow">
          <div class="impactCard">
            <div class="impactLabel">Gaps surfaced (global)</div>
            <div class="impactValue" id="metricGaps">0</div>
          </div>
          <div class="impactCard">
            <div class="impactLabel">Paper avoided (global)</div>
            <div class="impactValue" id="metricPaper">0</div>
          </div>
          <div class="impactCard">
            <div class="impactLabel">Estimated $ saved (global)</div>
            <div class="impactValue" id="metricMoney">$0</div>
          </div>
        </div>

        <div class="nurseControls noPrint">
          <div class="nurseRow" style="gap:10px; flex-wrap:wrap;">
            <label class="pill pill--toggle" style="gap:8px;">
              <input id="showAllToggle" type="checkbox" />
              <span class="toggleTrack"></span>
              <span class="toggleLabel">Show all verifications</span>
            </label>

            <div class="seg" aria-label="Sort carts">
              <button id="sortEntryBtn" class="segBtn active" type="button">By entry</button>
              <button id="sortRiskBtn" class="segBtn" type="button">By risk</button>
            </div>

            <button id="printPdfBtn" class="pill pill--outline" type="button">Export Verification Record (PDF)</button>
          </div>
        </div>

        <div id="nursingLogContainer"></div>

        <!-- PRINT AREA -->
        <section id="nursingLogPrintArea">
          <div style="margin: 0 0 10px 0;">
            <div style="font-weight:900; font-size:16px;">Verifi ‚Äî Verification Summary</div>
            <div style="font-size:12px;">
              Category: <span id="printCartType"></span> ‚Ä¢ Generated: <span id="printGeneratedAt"></span>
            </div>
          </div>
          <div id="nursingLogPrintContainer"></div>
        </section>
      </section>

    </div>

    <!-- NURSING VIEW -->
    <div id="nursingView" class="hidden">

      <section class="panel">
        <div class="panelRow">
          <div class="panelTitle">Nursing Log (Paper Style)</div>
          <div class="panelSub" id="nursePaperMeta">Monthly record</div>
        </div>

        <div class="controlGrid" style="margin-top:10px;">
          <div>
            <div class="fieldLabel">Unit / Area (label)</div>
            <input id="nurseUnitName" class="cartInput" placeholder="e.g., 4th Floor Tower / ER Area" />
          </div>

          <div>
            <div class="fieldLabel">Month</div>
            <input id="nurseMonth" class="cartInput" type="month" />
          </div>
        </div>

        <div class="toolbarRow noPrint">
          <button id="nurseAddRowBtn" class="pill pill--outline" type="button">Add Today‚Äôs Row</button>
          <button id="nurseSaveBtn" class="pill pill--outline" type="button">Save</button>
          <button id="nursePrintBtn" class="pill pill--outline" type="button">Print / Save PDF</button>
          <button id="nurseClearBtn" class="pill pill--outline" type="button">Clear Month</button>
        </div>

        <div class="miniHint">
          Nurses: mirrors your paper crash cart log (one row per day). Techs do NOT fill this out.
        </div>
      </section>

      <section class="panel">
        <div id="nurseTableWrap"></div>

        <section id="nursePrintArea">
          <div style="margin: 0 0 10px 0;">
            <div style="font-weight:900; font-size:16px;">Verifi ‚Äî Nursing Crash Cart Log</div>
            <div style="font-size:12px;">
              Unit: <span id="nursePrintUnit"></span> ‚Ä¢ Month: <span id="nursePrintMonth"></span>
            </div>
          </div>
          <div id="nursePrintTableWrap"></div>
        </section>
      </section>

    </div>

  </div>

  <div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true"></div>

  <!-- IMPORTANT: bump v= if Safari caches -->
  <script src="app.js?v=203"></script>
</body>
</html>
